!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return a}));var o=function(){try{return Function("return this")()||(0,eval)("this")}catch(e){return"object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof t&&t.global===t?t:this}}();function r(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){a(o.response,e,n)},o.onerror=function(){console.error("could not download file")},o.send()}function i(t){var e=new XMLHttpRequest;return e.open("HEAD",t,!1),e.send(),e.status>=200&&e.status<=299}function s(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a=o.saveAs||"object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype?function(t,e,n){var a=o.URL||o.webkitURL,l=document.createElement("a");e=e||t.name||"download",l.download=e,l.rel="noopener","string"==typeof t?(l.href=t,l.origin!==location.origin?i(l.href)?r(t,e,n):s(l,l.target="_blank"):s(l)):(l.href=a.createObjectURL(t),setTimeout((function(){a.revokeObjectURL(l.href)}),4e4),setTimeout((function(){s(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download","string"==typeof t)if(i(t))r(t,e,n);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout((function(){s(o)}))}else navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Depricated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t}(t,n),e)}:function(t,e,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return r(t,e,n);var s="application/octet-stream"===t.type,a=/constructor/i.test(o.HTMLElement)||o.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&a)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},c.readAsDataURL(t)}else{var f=o.URL||o.webkitURL,d=f.createObjectURL(t);i?i.location=d:location.href=d,i=null,setTimeout((function(){f.revokeObjectURL(d)}),4e4)}}}).call(this,n(1))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},,,,function(t,e,n){"use strict";n.r(e);var o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},r={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",fadeColor:"transparent",animation:"spinner-line-fade-default",rotate:0,direction:1,speed:1,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:"0 0 1px transparent",position:"absolute"},i=function(){function t(t){void 0===t&&(t={}),this.opts=o({},r,t)}return t.prototype.spin=function(t){return this.stop(),this.el=document.createElement("div"),this.el.className=this.opts.className,this.el.setAttribute("role","progressbar"),s(this.el,{position:this.opts.position,width:0,zIndex:this.opts.zIndex,left:this.opts.left,top:this.opts.top,transform:"scale("+this.opts.scale+")"}),t&&t.insertBefore(this.el,t.firstChild||null),function(t,e){var n=Math.round(e.corners*e.width*500)/1e3+"px",o="none";!0===e.shadow?o="0 2px 4px #000":"string"==typeof e.shadow&&(o=e.shadow);for(var r=function(t){for(var e=/^\s*([a-zA-Z]+\s+)?(-?\d+(\.\d+)?)([a-zA-Z]*)\s+(-?\d+(\.\d+)?)([a-zA-Z]*)(.*)$/,n=[],o=0,r=t.split(",");o<r.length;o++){var i=r[o].match(e);if(null!==i){var s=+i[2],a=+i[5],l=i[4],c=i[7];0!==s||l||(l=c),0!==a||c||(c=l),l===c&&n.push({prefix:i[1]||"",x:s,y:a,xUnits:l,yUnits:c,end:i[8]})}}return n}(o),i=0;i<e.lines;i++){var c=~~(360/e.lines*i+e.rotate),f=s(document.createElement("div"),{position:"absolute",top:-e.width/2+"px",width:e.length+e.width+"px",height:e.width+"px",background:a(e.fadeColor,i),borderRadius:n,transformOrigin:"left",transform:"rotate("+c+"deg) translateX("+e.radius+"px)"}),d=i*e.direction/e.lines/e.speed;d-=1/e.speed;var u=s(document.createElement("div"),{width:"100%",height:"100%",background:a(e.color,i),borderRadius:n,boxShadow:l(r,c),animation:1/e.speed+"s linear "+d+"s infinite "+e.animation});f.appendChild(u),t.appendChild(f)}}(this.el,this.opts),this},t.prototype.stop=function(){return this.el&&("undefined"!=typeof requestAnimationFrame?cancelAnimationFrame(this.animateId):clearTimeout(this.animateId),this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.el=void 0),this},t}();function s(t,e){for(var n in e)t.style[n]=e[n];return t}function a(t,e){return"string"==typeof t?t:t[e%t.length]}function l(t,e){for(var n=[],o=0,r=t;o<r.length;o++){var i=r[o],s=c(i.x,i.y,e);n.push(i.prefix+s[0]+i.xUnits+" "+s[1]+i.yUnits+i.end)}return n.join(", ")}function c(t,e,n){var o=n*Math.PI/180,r=Math.sin(o),i=Math.cos(o);return[Math.round(1e3*(t*i+e*r))/1e3,Math.round(1e3*(-t*r+e*i))/1e3]}function f(t){return t>=0&&t<129||63728==t||t>=65377&&t<65440||t>=63729&&t<63732}function d(t){let e=0;for(let n=0;n<t.length;n++){f(t.charCodeAt(n))?e+=.5:e+=1}return e}function u(t,e){const n={to_zip:[3.5,1],to_tel1:[2,1],to_tel2:[2,1],to_tel3:[2,1],from_zip:[3.5,1],from_tel1:[2,1],from_tel2:[2,1],from_tel3:[2,1],to_add:[14,4],to_name:[13,2],from_add:[20,2],from_name:[20,2],desc:[19,2],plus_or_light:[2.5,1]},o=t.split("__")[0];if(!(o in n))return!1;const r=n[o],i=e.split("\n");return function(t,e){for(let n=0,o=t.length;n<o;n++)if(d(t[n])>e)return!0;return!1}(i,r[0])||i.length>r[1]}function p(t){u(t.id,t.value)?t.style.backgroundColor="#eeabaf":t.style.backgroundColor=""}function m(){p(this);const t=w();sessionStorage.rows=JSON.stringify(t)}function _(t,e){null==e&&(e=document);const n=e.querySelectorAll(t);return Array.prototype.slice.call(n,0)}function h(t){if(0==t.length)return;let e="";e+="<tr>\n<th></th>\n";for(let n in t[0])e+="\t<th>"+n+"</th>\n";e+="</tr>\n";for(let n=0;n<t.length;n++){const o=t[n];e+="<tr>\n";const r=n+1;e+=`<th>${r}</th>\n`;for(let t in o){const n=o[t];let i="wide";(t.indexOf("_zip")>-1||t.indexOf("_tel")>-1||t.indexOf("_or_")>-1)&&(i="narrow"),e+=`<td>\n                <textarea rows=4 class="${i} ${t}" id="${t}__${r}">${n}</textarea>\n            </td>`}e+="\n</tr>\n"}const n=document.getElementById("table1");n.innerHTML=e,_("textarea",n).forEach((function(t,e){p(t)})),_("textarea",n).forEach((function(t,e){t.onkeyup=m})),function(t){const e={to_zip:[7,1],to_tel1:[4,1],to_tel2:[4,1],to_tel3:[4,1],from_zip:[7,1],from_tel1:[4,1],from_tel2:[4,1],from_tel3:[4,1],plus_or_light:[5,1]};_("textarea.narrow",t).forEach((function(t,n){const o=t.id.split("__")[0],r=e[o][0];t.title=`半角${r}文字以下`}))}(n),function(t){const e={to_add:[14,4],to_name:[13,2],from_add:[20,2],from_name:[20,2],desc:[19,2]};_("textarea.wide",t).forEach((function(t,n){const o=t.id.split("__")[0],r=e[o][0],i=e[o][1];t.title=`${r}文字x${i}行以下`}))}(n),function(t){const e={to_zip:"お届け先郵便番号",to_add:"お届け先住所",to_name:"お届け先おなまえ",to_tel1:"お届け先電話番号1",to_tel2:"お届け先電話番号2",to_tel3:"お届け先電話番号3",from_zip:"ご依頼主郵便番号",from_add:"ご依頼主住所",from_name:"ご依頼主おなまえ",from_tel1:"ご依頼主電話番号1",from_tel2:"ご依頼主電話番号2",from_tel3:"ご依頼主電話番号3",desc:"品名",plus_or_light:"プラス or ライト"},n=Object.keys(e);_("th:nth-of-type(n+2)",t).forEach((function(t,o){const r=n[o];t.title=e[r]}))}(n)}function w(){const t=document.getElementById("table1"),e=[];_("tr:nth-of-type(1) th:nth-of-type(n+2)",t).forEach((function(t,n){e.push(t.innerText)}));var n=[];return _("tr:nth-of-type(n+2)",t).forEach((function(t,o){const r={};_("textarea",t).forEach((function(t,n){const o=e[n];r[o]=t.value})),n.push(r)})),n}const g=200111.041839;function y(t){if(!window.Worker)throw alert("このブラウザでは利用できません。"),window.Worker;const e=window.URL||window.webkitURL,n=new e("./",function(){if(document.currentScript)return document.currentScript.src;var t=document.getElementsByTagName("script"),e=t[t.length-1];return e.src?e.src:void 0}()).href;let o="?"+g;0==n.indexOf("file://")&&(o="?"+Math.random());let r={};try{r=function(t){const r=new Blob(['importScripts("'+n+t+o+'");'],{type:"text/javascript"}),i=e.createObjectURL(r);return new Worker(i)}(t)}catch(e){console.log(e),r=new Worker(t)}return r.info={},r.info.baseURL=n,r.info.q=o,r.info.c=0,r}const v=4==parseInt("00100",2),b=y("myCsvLib/csvread_worker.js"),x=["to_zip","to_add","to_name","to_tel1","to_tel2","to_tel3","from_zip","from_add","from_name","from_tel1","from_tel2","from_tel3","desc","plus_or_light"].join(" ");function E(t){const e=t.target.files[0];window.sp_spin(),b.postMessage({file:e,info:b.info}),b.info.c++}b.onmessage=function(t){if(!t.data)throw window.sp_stop(),alert("Error: "+t.data),"error: "+t.data;let e=t.data;const n=Object.keys(e[0]);if(n.join(" ")!=x)throw window.sp_stop(),alert("フォーマットが違います。"),n;v&&(e=e.slice(0,5)),h(e),sessionStorage.rows=JSON.stringify(e),b.info.c=0,window.sp_stop()};var k=n(0);const j=y("myCsvLib/csvsave_worker.js");function O(){const t=w();0!=t.length?(sessionStorage.rows=JSON.stringify(t),window.sp_spin(),j.postMessage({rows:t,info:j.info}),j.info.c++):alert("データがありません")}j.onmessage=function(t){if(!t.data)throw window.sp_stop(),alert("Error: "+t.data),"error: "+t.data;const e=t.data;Object(k.a)(e,"labels.csv"),j.info.c=0,window.sp_stop()};const S=[{to_zip:"9999999",to_add:"埼玉県北葛飾郡杉戸町\n木津内4-3-6\n木津内アパート316",to_name:"遠藤栄三郎様方\n遠藤栄四郎",to_tel1:"888",to_tel2:"8206",to_tel3:"5103",from_zip:"9999999",from_add:"依頼主県依頼主市依頼主町\n1-23-45",from_name:"依頼田 主雄\n主子",from_tel1:"888",from_tel2:"1234",from_tel3:"5678",desc:"インフィニティ\nジェム",plus_or_light:"plus"},{to_zip:"9999999",to_add:"徳島県吉野川市\n美郷月野\n3-6-12\n美郷月野マンション113",to_name:"伊藤沙也香",to_tel1:"888",to_tel2:"8207",to_tel3:"5104",from_zip:"9999999",from_add:"依頼主県依頼主市依頼主町\n1-23-45",from_name:"依頼田 主雄\n主子",from_tel1:"888",from_tel2:"1234",from_tel3:"5678",desc:"インフィニティ\nジェム",plus_or_light:"light"},{to_zip:"9999999",to_add:"大阪府堺市南区\n高尾1-15-18",to_name:"皆川孝次",to_tel1:"888",to_tel2:"8208",to_tel3:"5105",from_zip:"9999999",from_add:"依頼主県依頼主市依頼主町\n1-23-45",from_name:"依頼田 主雄\n主子",from_tel1:"888",from_tel2:"1234",from_tel3:"5678",desc:"インフィニティ\nジェム",plus_or_light:"plus"},{to_zip:"9999999",to_add:"福島県二本松市\n下山田2-14-3\nステージ下山田418",to_name:"田代完治",to_tel1:"888",to_tel2:"8209",to_tel3:"5106",from_zip:"9999999",from_add:"依頼主県依頼主市依頼主町\n1-23-45",from_name:"依頼田 主雄\n主子",from_tel1:"888",from_tel2:"1234",from_tel3:"5678",desc:"インフィニティ\nジェム",plus_or_light:"light"},{to_zip:"9999999",to_add:"和歌山県有田郡有田川町\n上六川4-1-11",to_name:"筒井宗雄",to_tel1:"888",to_tel2:"8210",to_tel3:"5107",from_zip:"9999999",from_add:"依頼主県依頼主市依頼主町\n1-23-45",from_name:"依頼田 主雄\n主子",from_tel1:"888",from_tel2:"1234",from_tel3:"5678",desc:"インフィニティ\nジェム",plus_or_light:"plus"}];function z(){h(S)}function B(){_("textarea").forEach((function(t,e){if(t.style.backgroundColor.length>0)throw alert("赤いセルの文字数を修正してください。"),"over length"}));let t=w();if(v&&(t=t.slice(0,5)),0===t.length)return void alert("データがありません");sessionStorage.rows=JSON.stringify(t),window.sp_spin(document.getElementById("spin"));const e=y("myPdfLib/pdf_worker.js");e.postMessage({rows:t,info:e.info}),e.info.c++,e.onmessage=function(t){if(t.data.err)throw sp.stop(),alert("Error: "+t.data.result),"error: "+t.data.result;Object(k.a)(t.data.result,"labels.pdf"),e.info.c=0,window.sp_stop()}}const I=new i({length:38,width:17,radius:45,top:"50%",position:"fixed",lines:8});window.sp_spin=function(){I.spin(document.getElementById("spin")),document.getElementById("mask").style.visibility="visible"},window.sp_stop=function(){I.stop(),document.getElementById("mask").style.visibility="hidden"},document.onreadystatechange=function(t){var e=document.readyState;if("interactive"==e)window.sp_spin();else if("complete"==e){if(!v){document.getElementById("adv").style.visibility="hidden"}document.getElementById("sample_link").onclick=z,document.getElementById("foot_title").onclick=function(){open("https://www.post.japanpost.jp/service/letterpack/")};const t=document.getElementById("file1");t.onchange=E,document.getElementById("load_btn").onclick=function(e){t.click()},document.getElementById("make_btn").onclick=B,document.getElementById("save_btn").onclick=O,document.getElementById("help_btn").onclick=function(){open("https://hamada2029.github.io/letterpack_label_csv/HELP.html")},function(){if(null!==sessionStorage.getItem("rows")){h(JSON.parse(sessionStorage.rows))}}(),window.sp_stop(),document.getElementById("base_div").style.visibility="visible"}}}]);